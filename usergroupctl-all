
MYNAME="$0";
MYARGS="$*";

. ./common.env
. ./utility.h

main()
{
	action="$1";

	mkdir -p $HOME_BASE_DIR;

	case "$action" in
	setup ) add_all ;;
	clean ) del_all ;;

	setupadmin ) add_all_group_to_admin ;;
	cleanadmin ) del_all_group_to_admin ;;

	check )
		echo "##### check GROUP"
		tail -15 /etc/group;
		echo "##### check USER"
		tail -15 /etc/passwd;
		;;
	* )
		pr_error "can't find command $action";
		exit 1;
		;;
	esac
}

add_all()
{
	for instdir in $REPO_DIR/*;
	do
		./usergroupctl addgroup $instdir
		./usergroupctl adduser $instdir
	done
}

add_all_group_to_admin()
{
	for instdir in $REPO_DIR/*;
	do
		./usergroupctl addgroupadmin $instdir
	done
}

del_all_group_to_admin()
{
	for instdir in $REPO_DIR/*;
	do
		./usergroupctl delgroupadmin $instdir
	done
}

del_all()
{
	for instdir in $REPO_DIR/*;
	do
		echo $instdir
		./usergroupctl deluser $instdir
		./usergroupctl delgroup $instdir
	done
}

main $*;

